# üé´ EventTickets Backend

Backend —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ–¥–∞–∂–∏ –±–∏–ª–µ—Ç–æ–≤ EventTickets –Ω–∞ Node.js + Express + SQLite.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
cd server
npm install
```

### 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
npm run init-db
```

### 3. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
# –ü—Ä–æ–¥–∞–∫—à–Ω
npm start

# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (—Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π)
npm run dev
```

### 4. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- **–ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å:** http://localhost:3000
- **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:** http://localhost:3000/admin
- **API —Å—Ç–∞—Ç—É—Å:** http://localhost:3000/api/status

## üîê –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞

**–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:**
- –õ–æ–≥–∏–Ω: `admin`
- –ü–∞—Ä–æ–ª—å: `admin123`

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏:

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
- `users` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–∞–¥–º–∏–Ω—ã)
- `events` - –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
- `ticket_types` - —Ç–∏–ø—ã –±–∏–ª–µ—Ç–æ–≤
- `orders` - –∑–∞–∫–∞–∑—ã
- `order_items` - —ç–ª–µ–º–µ–Ω—Ç—ã –∑–∞–∫–∞–∑–æ–≤
- `settings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã
- `guest_checkins` - –æ—Ç–º–µ—Ç–∫–∏ –≤—Ö–æ–¥–∞ –≥–æ—Å—Ç–µ–π

### –§–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
`server/database/eventtickets.db`

## üîå API Endpoints

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `POST /api/auth/login` - –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
- `GET /api/auth/verify` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
- `POST /api/auth/logout` - –í—ã—Ö–æ–¥
- `POST /api/auth/change-password` - –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è

### –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
- `GET /api/events` - –°–ø–∏—Å–æ–∫ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π (–ø—É–±–ª–∏—á–Ω—ã–π)
- `GET /api/events/:id` - –û–¥–Ω–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ (–ø—É–±–ª–∏—á–Ω—ã–π)
- `POST /api/events` - –°–æ–∑–¥–∞—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ (–∞–¥–º–∏–Ω)
- `PUT /api/events/:id` - –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ (–∞–¥–º–∏–Ω)
- `DELETE /api/events/:id` - –£–¥–∞–ª–∏—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ (–∞–¥–º–∏–Ω)

### –ó–∞–∫–∞–∑—ã
- `POST /api/orders` - –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ (–ø—É–±–ª–∏—á–Ω—ã–π)
- `GET /api/orders` - –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ (–∞–¥–º–∏–Ω)
- `GET /api/orders/:id` - –û–¥–∏–Ω –∑–∞–∫–∞–∑
- `PATCH /api/orders/:id/status` - –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å (–∞–¥–º–∏–Ω)
- `POST /api/orders/:id/checkin` - –û—Ç–º–µ—Ç–∏—Ç—å –≤—Ö–æ–¥ (–∞–¥–º–∏–Ω)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏
- `GET /api/settings` - –ü—É–±–ª–∏—á–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `GET /api/settings/admin` - –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–∞–¥–º–∏–Ω)
- `PUT /api/settings` - –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–∞–¥–º–∏–Ω)
- `GET /api/settings/bank` - –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã:
- **JWT —Ç–æ–∫–µ–Ω—ã** –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **Bcrypt** –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
- **Helmet** –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **Rate limiting** (100 –∑–∞–ø—Ä–æ—Å–æ–≤/15 –º–∏–Ω—É—Ç)
- **CORS** –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- **SQL injection** –∑–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
1. –ò–∑–º–µ–Ω–∏—Ç–µ `JWT_SECRET` –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ñ–∞–π—Ä–≤–æ–ª
4. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
5. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
PORT=3000                    # –ü–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞
JWT_SECRET=your_secret_key   # –°–µ–∫—Ä–µ—Ç –¥–ª—è JWT
NODE_ENV=production          # –û–∫—Ä—É–∂–µ–Ω–∏–µ
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CORS:
–í `server.js` –∏–∑–º–µ–Ω–∏—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã:
```javascript
app.use(cors({
    origin: ['https://yourdomain.com'],
    credentials: true
}));
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
server/
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îú‚îÄ‚îÄ db.js              # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ eventtickets.db    # SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îú‚îÄ‚îÄ auth.js            # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ events.js          # –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ orders.js          # –ó–∞–∫–∞–∑—ã
‚îÇ   ‚îî‚îÄ‚îÄ settings.js        # –ù–∞—Å—Ç—Ä–æ–π–∫–∏
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ init-db.js         # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ server.js              # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª —Å–µ—Ä–≤–µ—Ä–∞
‚îî‚îÄ‚îÄ README.md
```

## üöÄ –î–µ–ø–ª–æ–π

### –ù–∞ VPS/—Å–µ—Ä–≤–µ—Ä–µ:
```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/your-username/eventtickets.git
cd eventtickets/server

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ë–î
npm run init-db

# –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä
npm start
```

### –° PM2 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
```bash
# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º PM2
npm install -g pm2

# –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
pm2 start server.js --name "eventtickets"

# –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
pm2 startup
pm2 save
```

### Docker:
```dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
EXPOSE 3000
CMD ["npm", "start"]
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏:
```bash
# PM2 –ª–æ–≥–∏
pm2 logs eventtickets

# –û–±—ã—á–Ω—ã–µ –ª–æ–≥–∏
tail -f /var/log/eventtickets.log
```

### –ú–µ—Ç—Ä–∏–∫–∏:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ PM2 Monit: `pm2 monit`
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Prometheus + Grafana
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
pm2 stop eventtickets

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞
git pull origin main

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
pm2 start eventtickets
```

## üÜò Troubleshooting

### –ü—Ä–æ–±–ª–µ–º—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö:
```bash
# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ë–î
rm database/eventtickets.db
npm run init-db
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ—Ä—Ç–æ–º:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–Ω—è—Ç—ã–µ –ø–æ—Ä—Ç—ã
netstat -tulpn | grep :3000

# –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
kill -9 PID
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏:
```bash
# –î–∞—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –ø–∞–ø–∫—É
chmod -R 755 /path/to/eventtickets
chown -R user:user /path/to/eventtickets
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **Email:** info@eventtickets.com
- **GitHub Issues:** https://github.com/your-username/eventtickets/issues
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API:** http://localhost:3000/api/status

---

**EventTickets Backend v1.0** - –ù–∞–¥–µ–∂–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã –±–∏–ª–µ—Ç–æ–≤! üéâ